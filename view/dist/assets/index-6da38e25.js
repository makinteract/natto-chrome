(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function N(){}const ve=e=>e;function Ae(e){return e()}function ye(){return Object.create(null)}function C(e){e.forEach(Ae)}function ue(e){return typeof e=="function"}function U(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let se;function Ze(e,t){return se||(se=document.createElement("a")),se.href=t,e===se.href}function Qe(e){return Object.keys(e).length===0}const Ce=typeof window<"u";let Pe=Ce?()=>window.performance.now():()=>Date.now(),we=Ce?e=>requestAnimationFrame(e):N;const V=new Set;function Le(e){V.forEach(t=>{t.c(e)||(V.delete(t),t.f())}),V.size!==0&&we(Le)}function He(e){let t;return V.size===0&&we(Le),{promise:new Promise(n=>{V.add(t={c:e,f:n})}),abort(){V.delete(t)}}}function f(e,t){e.appendChild(t)}function Ke(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function Xe(e){const t=m("style");return et(Ke(e),t),t.sheet}function et(e,t){return f(e.head||e,t),t.sheet}function j(e,t,n){e.insertBefore(t,n||null)}function S(e){e.parentNode&&e.parentNode.removeChild(e)}function tt(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function m(e){return document.createElement(e)}function B(e){return document.createTextNode(e)}function T(){return B(" ")}function nt(){return B("")}function O(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function p(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function it(e){return Array.from(e.childNodes)}function Q(e,t){t=""+t,e.data!==t&&(e.data=t)}function $e(e,t){e.value=t??""}function ke(e,t,n){for(let i=0;i<e.options.length;i+=1){const a=e.options[i];if(a.__value===t){a.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function at(e){const t=e.querySelector(":checked");return t&&t.__value}function ze(e,t,{bubbles:n=!1,cancelable:i=!1}={}){const a=document.createEvent("CustomEvent");return a.initCustomEvent(e,n,i,t),a}const le=new Map;let ce=0;function ot(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function st(e,t){const n={stylesheet:Xe(t),rules:{}};return le.set(e,n),n}function pe(e,t,n,i,a,o,s,r=0){const l=16.666/i;let c=`{
`;for(let h=0;h<=1;h+=l){const g=t+(n-t)*o(h);c+=h*100+`%{${s(g,1-g)}}
`}const d=c+`100% {${s(n,1-n)}}
}`,b=`__svelte_${ot(d)}_${r}`,w=Ke(e),{stylesheet:u,rules:v}=le.get(w)||st(w,e);v[b]||(v[b]=!0,u.insertRule(`@keyframes ${b} ${d}`,u.cssRules.length));const _=e.style.animation||"";return e.style.animation=`${_?`${_}, `:""}${b} ${i}ms linear ${a}ms 1 both`,ce+=1,b}function me(e,t){const n=(e.style.animation||"").split(", "),i=n.filter(t?o=>o.indexOf(t)<0:o=>o.indexOf("__svelte")===-1),a=n.length-i.length;a&&(e.style.animation=i.join(", "),ce-=a,ce||rt())}function rt(){we(()=>{ce||(le.forEach(e=>{const{ownerNode:t}=e.stylesheet;t&&S(t)}),le.clear())})}let ie;function te(e){ie=e}function Fe(){if(!ie)throw new Error("Function called outside component initialization");return ie}function lt(e){Fe().$$.on_mount.push(e)}function Be(){const e=Fe();return(t,n,{cancelable:i=!1}={})=>{const a=e.$$.callbacks[t];if(a){const o=ze(t,n,{cancelable:i});return a.slice().forEach(s=>{s.call(e,o)}),!o.defaultPrevented}return!0}}function Re(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(i=>i.call(this,t))}const W=[],Y=[];let Z=[];const _e=[],ct=Promise.resolve();let be=!1;function ut(){be||(be=!0,ct.then(Ue))}function H(e){Z.push(e)}function fe(e){_e.push(e)}const de=new Set;let J=0;function Ue(){if(J!==0)return;const e=ie;do{try{for(;J<W.length;){const t=W[J];J++,te(t),ft(t.$$)}}catch(t){throw W.length=0,J=0,t}for(te(null),W.length=0,J=0;Y.length;)Y.pop()();for(let t=0;t<Z.length;t+=1){const n=Z[t];de.has(n)||(de.add(n),n())}Z.length=0}while(W.length);for(;_e.length;)_e.pop()();be=!1,de.clear(),te(e)}function ft(e){if(e.fragment!==null){e.update(),C(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(H)}}function dt(e){const t=[],n=[];Z.forEach(i=>e.indexOf(i)===-1?t.push(i):n.push(i)),n.forEach(i=>i()),Z=t}let ee;function De(){return ee||(ee=Promise.resolve(),ee.then(()=>{ee=null})),ee}function ne(e,t,n){e.dispatchEvent(ze(`${t?"intro":"outro"}${n}`))}const re=new Set;let L;function qe(){L={r:0,c:[],p:L}}function Ge(){L.r||C(L.c),L=L.p}function M(e,t){e&&e.i&&(re.delete(e),e.i(t))}function A(e,t,n,i){if(e&&e.o){if(re.has(e))return;re.add(e),L.c.push(()=>{re.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}else i&&i()}const Je={duration:0};function We(e,t,n){const i={direction:"in"};let a=t(e,n,i),o=!1,s,r,l=0;function c(){s&&me(e,s)}function d(){const{delay:w=0,duration:u=300,easing:v=ve,tick:_=N,css:h}=a||Je;h&&(s=pe(e,0,1,u,w,v,h,l++)),_(0,1);const g=Pe()+w,k=g+u;r&&r.abort(),o=!0,H(()=>ne(e,!0,"start")),r=He($=>{if(o){if($>=k)return _(1,0),ne(e,!0,"end"),c(),o=!1;if($>=g){const x=v(($-g)/u);_(x,1-x)}}return o})}let b=!1;return{start(){b||(b=!0,me(e),ue(a)?(a=a(i),De().then(d)):d())},invalidate(){b=!1},end(){o&&(c(),o=!1)}}}function xe(e,t,n,i){const a={direction:"both"};let o=t(e,n,a),s=i?0:1,r=null,l=null,c=null;function d(){c&&me(e,c)}function b(u,v){const _=u.b-s;return v*=Math.abs(_),{a:s,b:u.b,d:_,duration:v,start:u.start,end:u.start+v,group:u.group}}function w(u){const{delay:v=0,duration:_=300,easing:h=ve,tick:g=N,css:k}=o||Je,$={start:Pe()+v,b:u};u||($.group=L,L.r+=1),r||l?l=$:(k&&(d(),c=pe(e,s,u,_,v,h,k)),u&&g(0,1),r=b($,_),H(()=>ne(e,u,"start")),He(x=>{if(l&&x>l.start&&(r=b(l,_),l=null,ne(e,r.b,"start"),k&&(d(),c=pe(e,s,r.b,r.duration,0,h,o.css))),r){if(x>=r.end)g(s=r.b,1-s),ne(e,r.b,"end"),l||(r.b?d():--r.group.r||C(r.group.c)),r=null;else if(x>=r.start){const I=x-r.start;s=r.a+r.d*h(I/r.duration),g(s,1-s)}}return!!(r||l)}))}return{run(u){ue(o)?De().then(()=>{o=o(a),w(u)}):w(u)},end(){d(),r=l=null}}}function he(e,t,n){const i=e.$$.props[t];i!==void 0&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function R(e){e&&e.c()}function z(e,t,n,i){const{fragment:a,after_update:o}=e.$$;a&&a.m(t,n),i||H(()=>{const s=e.$$.on_mount.map(Ae).filter(ue);e.$$.on_destroy?e.$$.on_destroy.push(...s):C(s),e.$$.on_mount=[]}),o.forEach(H)}function F(e,t){const n=e.$$;n.fragment!==null&&(dt(n.after_update),C(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ht(e,t){e.$$.dirty[0]===-1&&(W.push(e),ut(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function D(e,t,n,i,a,o,s,r=[-1]){const l=ie;te(e);const c=e.$$={fragment:null,ctx:[],props:o,update:N,not_equal:a,bound:ye(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:ye(),dirty:r,skip_bound:!1,root:t.target||l.$$.root};s&&s(c.root);let d=!1;if(c.ctx=n?n(e,t.props||{},(b,w,...u)=>{const v=u.length?u[0]:w;return c.ctx&&a(c.ctx[b],c.ctx[b]=v)&&(!c.skip_bound&&c.bound[b]&&c.bound[b](v),d&&ht(e,b)),w}):[],c.update(),d=!0,C(c.before_update),c.fragment=i?i(c.ctx):!1,t.target){if(t.hydrate){const b=it(t.target);c.fragment&&c.fragment.l(b),b.forEach(S)}else c.fragment&&c.fragment.c();t.intro&&M(e.$$.fragment),z(e,t.target,t.anchor,t.customElement),Ue()}te(l)}class q{$destroy(){F(this,1),this.$destroy=N}$on(t,n){if(!ue(n))return N;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const a=i.indexOf(n);a!==-1&&i.splice(a,1)}}$set(t){this.$$set&&!Qe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function gt(e){let t,n,i,a,o,s,r,l,c,d,b,w,u,v,_,h,g,k,$,x,I,E,y,P,X;return{c(){t=m("div"),n=m("div"),i=m("div"),a=m("button"),a.textContent="Fix grammar",o=T(),s=m("div"),r=m("button"),r.textContent="Elaborate",l=T(),c=m("div"),d=m("button"),d.textContent="Rewrite",b=T(),w=m("div"),u=m("button"),u.textContent="Summarize",v=T(),_=m("div"),h=m("button"),h.textContent="Translate to English",g=T(),k=m("div"),$=m("div"),x=m("span"),I=B(e[0]),E=T(),y=m("button"),y.textContent="Translate to",p(a,"class","btn btn-accent w-32"),p(i,"class","text-primary-content grid place-content-center rounded"),p(r,"class","btn btn-accent w-32"),p(s,"class","text-accent-content grid place-content-center rounded"),p(d,"class","btn btn-accent w-32"),p(c,"class","text-secondary-content grid place-content-center rounded"),p(u,"class","btn btn-accent w-32"),p(w,"class","text-secondary-content grid place-content-center rounded"),p(h,"class","btn btn-accent w-32"),p(_,"class","text-secondary-content grid place-content-center rounded"),p(x,"class","indicator-item indicator-top indicator-right badge badge-secondary"),p(y,"class","btn btn-accent w-32"),p($,"class","indicator"),p(k,"class","text-secondary-content grid place-content-center rounded"),p(n,"class","grid grid-cols-2 gap-4 gap-y-8"),p(t,"class","flex justify-center")},m(K,G){j(K,t,G),f(t,n),f(n,i),f(i,a),f(n,o),f(n,s),f(s,r),f(n,l),f(n,c),f(c,d),f(n,b),f(n,w),f(w,u),f(n,v),f(n,_),f(_,h),f(n,g),f(n,k),f(k,$),f($,x),f(x,I),f($,E),f($,y),P||(X=[O(a,"click",e[2]),O(r,"click",e[3]),O(d,"click",e[4]),O(u,"click",e[5]),O(h,"click",e[6]),O(y,"click",e[7])],P=!0)},p(K,[G]){G&1&&Q(I,K[0])},i:N,o:N,d(K){K&&S(t),P=!1,C(X)}}}function pt(e,t,n){const i=Be();let{language:a="EN"}=t;const o=()=>i("grammar"),s=()=>i("elaborate"),r=()=>i("rewrite"),l=()=>i("summarize"),c=()=>i("translate_english"),d=()=>i("translate");return e.$$set=b=>{"language"in b&&n(0,a=b.language)},[a,i,o,s,r,l,c,d]}class mt extends q{constructor(t){super(),D(this,t,pt,gt,U,{language:0})}}const _t=""+new URL("mini-natto-56922c88.png",import.meta.url).href;function Te(e){let t;return{c(){t=m("span"),p(t,"class","loading loading-spinner loading-sm")},m(n,i){j(n,t,i)},d(n){n&&S(t)}}}function bt(e){let t,n,i,a,o,s,r,l,c,d,b,w=e[0]&&Te();return{c(){t=m("div"),n=m("div"),i=m("a"),i.textContent="Chrome Natto",a=T(),w&&w.c(),o=T(),s=m("div"),r=m("div"),l=m("div"),c=m("div"),d=m("img"),p(i,"class","btn btn-ghost text-xl"),p(n,"class","flex-1"),p(d,"alt","Logo"),Ze(d.src,b=_t)||p(d,"src",b),p(c,"class","w-10 rounded-full"),p(l,"tabindex","0"),p(l,"role","button"),p(l,"class","btn btn-ghost btn-circle avatar"),p(r,"class","dropdown dropdown-end"),p(s,"class","flex-none gap-2"),p(t,"class","navbar")},m(u,v){j(u,t,v),f(t,n),f(n,i),f(n,a),w&&w.m(n,null),f(t,o),f(t,s),f(s,r),f(r,l),f(l,c),f(c,d)},p(u,[v]){u[0]?w||(w=Te(),w.c(),w.m(n,null)):w&&(w.d(1),w=null)},i:N,o:N,d(u){u&&S(t),w&&w.d()}}}function vt(e,t,n){let{processing:i=!1}=t;return e.$$set=a=>{"processing"in a&&n(0,i=a.processing)},[i]}class wt extends q{constructor(t){super(),D(this,t,vt,bt,U,{processing:0})}}function yt(e){let t,n,i,a,o,s;return{c(){t=m("div"),n=m("button"),n.innerHTML='<i class="fa-solid fa-home"></i>',i=T(),a=m("button"),a.innerHTML='<i class="fa-solid fa-cog"></i>',p(n,"class","active"),p(a,"class","active"),p(t,"class","btm-nav h-min-0 h-12")},m(r,l){j(r,t,l),f(t,n),f(t,i),f(t,a),o||(s=[O(n,"click",e[2]),O(a,"click",e[3])],o=!0)},p:N,i:N,o:N,d(r){r&&S(t),o=!1,C(s)}}}function $t(e,t,n){const i=Be();let{language:a="EN"}=t;const o=()=>i("home"),s=()=>i("options");return e.$$set=r=>{"language"in r&&n(1,a=r.language)},[i,a,o,s]}class kt extends q{constructor(t){super(),D(this,t,$t,yt,U,{language:1})}}function Ne(e,t,n){const i=e.slice();return i[5]=t[n],i}function Se(e){let t,n=e[5]+"",i,a;return{c(){t=m("option"),i=B(n),t.__value=a=e[5],t.value=t.__value},m(o,s){j(o,t,s),f(t,i)},p(o,s){s&4&&n!==(n=o[5]+"")&&Q(i,n),s&4&&a!==(a=o[5])&&(t.__value=a,t.value=t.__value)},d(o){o&&S(t)}}}function xt(e){let t,n,i,a,o,s,r,l=(e[0]||"Pick one")+"",c,d,b,w,u=e[2],v=[];for(let _=0;_<u.length;_+=1)v[_]=Se(Ne(e,u,_));return{c(){t=m("label"),n=m("div"),i=m("span"),a=B(e[1]),o=T(),s=m("select"),r=m("option"),c=B(l);for(let _=0;_<v.length;_+=1)v[_].c();p(i,"class","label-text"),p(n,"class","label"),r.disabled=!0,r.selected=!0,r.__value=d=e[0]||"Pick one",r.value=r.__value,p(s,"class","select select-bordered"),e[0]===void 0&&H(()=>e[4].call(s)),p(t,"class","form-control w-full max-w-xs")},m(_,h){j(_,t,h),f(t,n),f(n,i),f(i,a),f(t,o),f(t,s),f(s,r),f(r,c);for(let g=0;g<v.length;g+=1)v[g]&&v[g].m(s,null);ke(s,e[0],!0),b||(w=[O(s,"change",e[4]),O(s,"change",e[3])],b=!0)},p(_,[h]){if(h&2&&Q(a,_[1]),h&1&&l!==(l=(_[0]||"Pick one")+"")&&Q(c,l),h&5&&d!==(d=_[0]||"Pick one")&&(r.__value=d,r.value=r.__value),h&4){u=_[2];let g;for(g=0;g<u.length;g+=1){const k=Ne(_,u,g);v[g]?v[g].p(k,h):(v[g]=Se(k),v[g].c(),v[g].m(s,null))}for(;g<v.length;g+=1)v[g].d(1);v.length=u.length}h&5&&ke(s,_[0])},i:N,o:N,d(_){_&&S(t),tt(v,_),b=!1,C(w)}}}function Tt(e,t,n){let{label:i=""}=t,{options:a=[]}=t,{selection:o=""}=t;function s(l){Re.call(this,e,l)}function r(){o=at(this),n(0,o),n(2,a)}return e.$$set=l=>{"label"in l&&n(1,i=l.label),"options"in l&&n(2,a=l.options),"selection"in l&&n(0,o=l.selection)},[o,i,a,s,r]}class Ee extends q{constructor(t){super(),D(this,t,Tt,xt,U,{label:1,options:2,selection:0})}}function Nt(e){let t,n,i,a,o,s,r,l;return{c(){t=m("label"),n=m("div"),i=m("span"),a=B(e[1]),o=T(),s=m("input"),p(i,"class","label-text"),p(n,"class","label"),p(s,"type","password"),p(s,"placeholder",e[0]),p(s,"class","input input-bordered"),p(t,"class","form-control w-full max-w-xs")},m(c,d){j(c,t,d),f(t,n),f(n,i),f(i,a),f(t,o),f(t,s),$e(s,e[0]),r||(l=[O(s,"input",e[3]),O(s,"change",e[2])],r=!0)},p(c,[d]){d&2&&Q(a,c[1]),d&1&&p(s,"placeholder",c[0]),d&1&&s.value!==c[0]&&$e(s,c[0])},i:N,o:N,d(c){c&&S(t),r=!1,C(l)}}}function St(e,t,n){let{label:i=""}=t,{value:a=""}=t;function o(r){Re.call(this,e,r)}function s(){a=this.value,n(0,a)}return e.$$set=r=>{"label"in r&&n(1,i=r.label),"value"in r&&n(0,a=r.value)},[a,i,o,s]}class Et extends q{constructor(t){super(),D(this,t,St,Nt,U,{label:1,value:0})}}function Mt(e){const t=e-1;return t*t*t+1}function Me(e,{delay:t=0,duration:n=400,easing:i=ve}={}){const a=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:i,css:o=>`opacity: ${o*a}`}}function Ve(e,{delay:t=0,duration:n=400,easing:i=Mt,axis:a="y"}={}){const o=getComputedStyle(e),s=+o.opacity,r=a==="y"?"height":"width",l=parseFloat(o[r]),c=a==="y"?["top","bottom"]:["left","right"],d=c.map(g=>`${g[0].toUpperCase()}${g.slice(1)}`),b=parseFloat(o[`padding${d[0]}`]),w=parseFloat(o[`padding${d[1]}`]),u=parseFloat(o[`margin${d[0]}`]),v=parseFloat(o[`margin${d[1]}`]),_=parseFloat(o[`border${d[0]}Width`]),h=parseFloat(o[`border${d[1]}Width`]);return{delay:t,duration:n,easing:i,css:g=>`overflow: hidden;opacity: ${Math.min(g*20,1)*s};${r}: ${g*l}px;padding-${c[0]}: ${g*b}px;padding-${c[1]}: ${g*w}px;margin-${c[0]}: ${g*u}px;margin-${c[1]}: ${g*v}px;border-${c[0]}-width: ${g*_}px;border-${c[1]}-width: ${g*h}px;`}}function je(e){let t,n,i,a,o,s,r;return{c(){t=m("div"),n=m("div"),i=m("span"),a=B(e[0]),p(n,"class",o="alert text-wrap "+(e[2]?"alert-info":"alert-error")),p(t,"class","toast toast-end")},m(l,c){j(l,t,c),f(t,n),f(n,i),f(i,a),r=!0},p(l,c){(!r||c&1)&&Q(a,l[0]),(!r||c&4&&o!==(o="alert text-wrap "+(l[2]?"alert-info":"alert-error")))&&p(n,"class",o)},i(l){r||(H(()=>{r&&(s||(s=xe(t,Me,{},!0)),s.run(1))}),r=!0)},o(l){s||(s=xe(t,Me,{},!1)),s.run(0),r=!1},d(l){l&&S(t),l&&s&&s.end()}}}function jt(e){let t,n,i=e[1]&&je(e);return{c(){i&&i.c(),t=nt()},m(a,o){i&&i.m(a,o),j(a,t,o),n=!0},p(a,[o]){a[1]?i?(i.p(a,o),o&2&&M(i,1)):(i=je(a),i.c(),M(i,1),i.m(t.parentNode,t)):i&&(qe(),A(i,1,1,()=>{i=null}),Ge())},i(a){n||(M(i),n=!0)},o(a){A(i),n=!1},d(a){i&&i.d(a),a&&S(t)}}}const Oe=40;function Ot(e,t,n){let i="",a=!1,o=!0;function s(r,l){n(0,i=r.length>Oe?r.slice(0,Oe)+"...":r),n(1,a=!0),n(2,o=l),setTimeout(()=>{n(1,a=!1)},3e3)}return[i,a,o,s]}class It extends q{constructor(t){super(),D(this,t,Ot,jt,U,{setMessage:3})}get setMessage(){return this.$$.ctx[3]}}function ae(e={model:"gpt-4o-mini",temperature:0},t=[]){return n=>{const i={role:"user",content:n},a=[...t,i];return Ct(a,e).then(o=>{const s=At(o);return t.push(i),t.push(s.message),s})}}function oe(e){return e.message}function At(e){const{error:t,object:n,created:i,model:a,usage:o,system_fingerprint:s}=e;if(t)throw t.message;const r=e.choices[0];if(r.finish_reason==="stop")return{object:n,created:i,model:a,usage:o,system_fingerprint:s,message:r.message};throw new Error("No response from AI")}function Ct(e,t){let{apiKey:n,...i}=t;try{n||(n={}.OPENAI_API_KEY)}catch{}return fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({...i,messages:e})}).then(a=>a.json())}async function Pt(){const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e}async function Lt(){return(await Pt()).id}async function Ht(e){const t=await Lt();if(!t)return;let n=await chrome.webNavigation.getAllFrames({tabId:t}),i=[];return n==null||n.forEach(a=>{let o=chrome.tabs.sendMessage(t,e,{frameId:a.frameId});i.push(o)}),Promise.all(i)}function ge(e){return new Promise((t,n)=>{chrome.storage.local.get(e,async i=>{const a=i[e];t(a)})})}async function Kt(e,t,n){return(await(await ae({model:t,apiKey:e}))(`
        Fix the typos, punctuation and lettercase of this text. 
        Keep the same language, tone and style. 
        Do not add any text that is not there. 
        If the sentence is already correct, just leave it.
        If the sentence cannot be fixed, just leave it as it is.
        If no text is provided, just leave it as it is.
        Do not provide explanations or comments.
        Output the text as a json object with the following keys: text, and html (which is the text with corresponding tags for each element to maintain the original formatting, but do not add any additional formatting such as markdown, and do not write something like "Here the text" or do not use markings to indicate the HTML code is starting).
       
        Here the text:${n}`).then(oe)).content}async function zt(e,t,n){return(await(await ae({model:t,apiKey:e}))(`
        Elaborate on the following text with more details. Provide more background or information. The final text should be longer than the original text.
        Expand on the ideas, but keep the length of the final text similar in length to the input of the text below.
        If a list of bullet points is provided, expand on each point in a paragraph.
        Keep the same language.
        If no text is provided, just leave it as it is.
        Output the text as a json object with the following keys: text, and html (which is the text with corresponding tags for each element to maintain the original formatting, but do not add any additional formatting such as markdown, and do not write something like "Here the text" or do not use markings to indicate the HTML code is starting).

        Here the text:${n}`).then(oe)).content}async function Ft(e,t,n){return(await(await ae({model:t,apiKey:e}))(`
        Paraphrase this text. Rewrite it with different words but keep the same length. 
        Keep the same language. If no text is provided, just leave it as it is.
        Output the text as a json object with the following keys: text, and html (which is the text with corresponding tags for each element to maintain the original formatting, but do not add any additional formatting such as markdown, and do not write something like "Here the text" or do not use markings to indicate the HTML code is starting).

        Here the text:${n}`).then(oe)).content}async function Bt(e,t,n){return(await(await ae({model:t,apiKey:e}))(`
        Summarize the following text. Keep the same language but reduce the length of the text.
        If no text is provided, just leave it as it is.
        Output the text as a json object with the following keys: text, and html (which is the text with corresponding tags for each element to maintain the original formatting, but do not add any additional formatting such as markdown, and do not write something like "Here the text" or do not use markings to indicate the HTML code is starting).

        Here the text:${n}`).then(oe)).content}async function Ie(e,t,n,i){return(await(await ae({model:t,apiKey:e}))(`
      Translate the text to the ${i} language.
      Do not modify the text, its meaning or its tone.
      If no text is provided, just leave it as it is.
      Output the text as a json object with the following keys: text, and html (which is the text with corresponding tags for each element to maintain the original formatting, but do not add any additional formatting such as markdown, and do not write something like "Here the text" or do not use markings to indicate the HTML code is starting).

      Here the text:${n}`).then(oe)).content}const Rt=["Abkhaz","Afar","Afrikaans","Akan","Albanian","Amharic","Arabic","Aragonese","Armenian","Assamese","Avaric","Avestan","Aymara","Azerbaijani","Bambara","Bashkir","Basque","Belarusian","Bengali","Bihari","Bislama","Bosnian","Breton","Bulgarian","Burmese","Catalan","Chamorro","Chechen","Chichewa","Chinese","Chuvash","Cornish","Corsican","Cree","Croatian","Czech","Danish","Divehi","Dutch","Dzongkha","English","Esperanto","Estonian","Ewe","Faroese","Fijian","Finnish","French","Fulah","Galician","Georgian","German","Greek","Guarani","Gujarati","Haitian","Hausa","Hebrew","Herero","Hindi","Hiri Motu","Hungarian","Interlingua","Indonesian","Interlingue","Irish","Igbo","Inupiaq","Ido","Icelandic","Italian","Inuktitut","Japanese","Javanese","Kalaallisut","Kannada","Kanuri","Kashmiri","Kazakh","Khmer","Kikuyu","Kinyarwanda","Kirghiz","Komi","Kongo","Korean","Kurdish","Kwanyama","Latin","Luxembourgish","Ganda","Limburgish","Lingala","Lao","Lithuanian","Luba-Katanga","Latvian","Manx","Macedonian","Malagasy","Malay","Malayalam","Maltese","Maori","Marathi","Marshallese","Mongolian","Nauru","Navajo","Norwegian Bokmål","North Ndebele","Nepali","Ndonga","Norwegian Nynorsk","Norwegian","Nuosu","South Ndebele","Occitan","Ojibwa","Old Church Slavonic","Oromo","Oriya","Ossetian","Panjabi","Pāli","Persian","Polish","Pashto","Portuguese","Quechua","Romansh","Kirundi","Romanian","Russian","Sanskrit","Sardinian","Sindhi","Northern Sami","Samoan","Sango","Serbian","Gaelic","Shona","Sinhala","Slovak","Slovenian","Somali","Southern Sotho","Spanish","Sundanese","Swahili","Swati","Swedish","Tamil","Telugu","Tajik","Thai","Tigrinya","Tibetan","Turkmen","Tagalog","Tswana","Tonga","Turkish","Tsonga","Tatar","Twi","Tahitian","Uyghur","Ukrainian","Urdu","Uzbek","Venda","Vietnamese","Volapük","Walloon","Wolof","Xhosa","Yiddish","Yoruba","Zhuang","Zulu"];function Ut(e){let t,n,i,a,o,s,r,l,c,d,b,w,u,v,_,h;function g(y){e[10](y)}let k={label:"Pick a language",options:Rt};e[1]!==void 0&&(k.selection=e[1]),a=new Ee({props:k}),Y.push(()=>he(a,"selection",g)),a.$on("change",e[8]);function $(y){e[11](y)}let x={label:"Pick a model",options:["gpt-4o-mini","gpt-4o"]};e[2]!==void 0&&(x.selection=e[2]),l=new Ee({props:x}),Y.push(()=>he(l,"selection",$)),l.$on("change",e[7]);function I(y){e[12](y)}let E={label:"Input your API key"};return e[3]!==void 0&&(E.value=e[3]),u=new Et({props:E}),Y.push(()=>he(u,"value",I)),u.$on("change",e[9]),{c(){t=m("div"),n=m("div"),i=m("div"),R(a.$$.fragment),s=T(),r=m("div"),R(l.$$.fragment),d=T(),b=m("div"),b.textContent="Settings",w=T(),R(u.$$.fragment),p(i,"class","grid"),p(r,"class","grid mt-4"),p(b,"class","divider"),p(n,"class","w-64 h-96"),p(t,"class","flex justify-center")},m(y,P){j(y,t,P),f(t,n),f(n,i),z(a,i,null),f(n,s),f(n,r),z(l,r,null),f(n,d),f(n,b),f(n,w),z(u,n,null),h=!0},p(y,P){e=y;const X={};!o&&P&2&&(o=!0,X.selection=e[1],fe(()=>o=!1)),a.$set(X);const K={};!c&&P&4&&(c=!0,K.selection=e[2],fe(()=>c=!1)),l.$set(K);const G={};!v&&P&8&&(v=!0,G.value=e[3],fe(()=>v=!1)),u.$set(G)},i(y){h||(M(a.$$.fragment,y),M(l.$$.fragment,y),M(u.$$.fragment,y),_||H(()=>{_=We(t,Ve,{axis:"x",duration:Ye}),_.start()}),h=!0)},o(y){A(a.$$.fragment,y),A(l.$$.fragment,y),A(u.$$.fragment,y),h=!1},d(y){y&&S(t),F(a),F(l),F(u)}}}function Dt(e){let t,n,i,a;return n=new mt({props:{language:e[1]}}),n.$on("grammar",e[6]("fix_grammar")),n.$on("elaborate",e[6]("elaborate")),n.$on("rewrite",e[6]("rewrite")),n.$on("summarize",e[6]("summarize")),n.$on("translate_english",e[6]("translate_english")),n.$on("translate",e[6]("translate")),{c(){t=m("div"),R(n.$$.fragment),p(t,"class","flex items-center justify-center")},m(o,s){j(o,t,s),z(n,t,null),a=!0},p(o,s){e=o;const r={};s&2&&(r.language=e[1]),n.$set(r)},i(o){a||(M(n.$$.fragment,o),i||H(()=>{i=We(t,Ve,{axis:"x",duration:Ye}),i.start()}),a=!0)},o(o){A(n.$$.fragment,o),a=!1},d(o){o&&S(t),F(n)}}}function qt(e){let t,n,i,a,o,s,r,l,c,d,b;i=new wt({props:{processing:e[5]}});const w=[Dt,Ut],u=[];function v(h,g){return h[0]?0:1}o=v(e),s=u[o]=w[o](e),l=new kt({}),l.$on("home",e[13]),l.$on("options",e[14]);let _={};return d=new It({props:_}),e[15](d),{c(){t=m("div"),n=m("div"),R(i.$$.fragment),a=T(),s.c(),r=T(),R(l.$$.fragment),c=T(),R(d.$$.fragment),p(n,"class","mb-6"),p(t,"class","bg-base-100 ml-4 mr-4 w-80 h-96")},m(h,g){j(h,t,g),f(t,n),z(i,n,null),f(t,a),u[o].m(t,null),f(t,r),z(l,t,null),j(h,c,g),z(d,h,g),b=!0},p(h,[g]){const k={};g&32&&(k.processing=h[5]),i.$set(k);let $=o;o=v(h),o===$?u[o].p(h,g):(qe(),A(u[$],1,1,()=>{u[$]=null}),Ge(),s=u[o],s?s.p(h,g):(s=u[o]=w[o](h),s.c()),M(s,1),s.m(t,r));const x={};d.$set(x)},i(h){b||(M(i.$$.fragment,h),M(s),M(l.$$.fragment,h),M(d.$$.fragment,h),b=!0)},o(h){A(i.$$.fragment,h),A(s),A(l.$$.fragment,h),A(d.$$.fragment,h),b=!1},d(h){h&&S(t),F(i),u[o].d(),F(l),h&&S(c),e[15](null),F(d,h)}}}const Ye=400;function Gt(e,t,n){let i=!0,a="English",o="gpt-4o-mini",s="sk-proj-TrU-RWW...",r,l=!1;lt(async()=>{n(3,s=await ge("natto_apikey")??s),n(2,o=await ge("natto_model")??o),n(1,a=await ge("natto_translation_language")??a),chrome.runtime.sendMessage({ready:!0})});function c($){return async function(){let x=[];try{x=await Ht({action:"get_selected_text"})}catch(y){r.setMessage("Natto does not support this page.",!1),console.error(y),n(5,l=!1);return}const I=x.find(({text:y})=>y.length>0);if(!I||!I.text){r.setMessage("No text selected",!1);return}let{text:E}=I||{text:""};n(5,l=!0);try{if($=="fix_grammar"){const y=await Kt(s,o,E);navigator.clipboard.writeText(JSON.parse(y).text)}else if($=="elaborate"){const y=await zt(s,o,E);navigator.clipboard.writeText(JSON.parse(y).text)}else if($=="rewrite"){const y=await Ft(s,o,E);navigator.clipboard.writeText(JSON.parse(y).text)}else if($=="summarize"){const y=await Bt(s,o,E);navigator.clipboard.writeText(JSON.parse(y).text)}else if($=="translate_english"){const y=await Ie(s,o,E,"English");console.log(y,E,a,o),navigator.clipboard.writeText(JSON.parse(y).text)}else if($=="translate"){const y=await Ie(s,o,E,a);navigator.clipboard.writeText(JSON.parse(y).text)}else throw new Error("Unable to perform this action")}catch{r.setMessage("Unable to perform this action",!0),n(5,l=!1);return}r.setMessage("Copied to clipboard",!0),n(5,l=!1)}}async function d($){await chrome.storage.local.set({natto_model:o}),r.setMessage(`Updated model: ${o}`,!0)}async function b($){await chrome.storage.local.set({natto_translation_language:a}),r.setMessage(`Updated language: ${a}`,!0)}async function w($){await chrome.storage.local.set({natto_apikey:s}),r.setMessage(`Updated key: ${s.substring(0,7)}...`,!0)}function u($){a=$,n(1,a)}function v($){o=$,n(2,o)}function _($){s=$,n(3,s)}const h=()=>n(0,i=!0),g=()=>n(0,i=!1);function k($){Y[$?"unshift":"push"](()=>{r=$,n(4,r)})}return[i,a,o,s,r,l,c,d,b,w,u,v,_,h,g,k]}class Jt extends q{constructor(t){super(),D(this,t,Gt,qt,U,{})}}new Jt({target:document.getElementById("app")});
